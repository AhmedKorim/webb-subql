fragment TokenDetailsFragment on Token {
  id
  address
  name
  decimals
  symbol
  isFungibleTokenWrapper
}
fragment FungibleTokenWrapperDetails on FungibleTokenWrapper {
  id
  name
  decimals
  symbol
  baseTokenSymbol
}

fragment FungibleTokenWrapperBasicDetails on VAnchor {
  id
  chainId
  typedChainId
  contractAddress
}

fragment VAnchorDetailsFragment on VAnchor {
  id
  chainId
  typedChainId
  contractAddress
  token {
    ...FungibleTokenWrapperDetails
  }

  finalValueLocked
  valueLocked
  totalFees
  totalWrappingFees

  numberOfDeposits
  numberOfWithdraws

  minDepositAmount
  maxDepositAmount

  averageDepositAmount
}

# Query All vAnchors
query vAnchorList($where: VAnchor_filter) {
  vanchors(where: $where) {
    ...VAnchorDetailsFragment
  }
}

query vAnchorDetails($id: ID!) {
  vanchor(id: $id) {
    ...VAnchorDetailsFragment
  }
}
query allTokens {
  tokens {
    ...TokenDetailsFragment
  }
}

query dayDetails($vAnchorId: String!) {
  vanchorDayDatas(
    first: 1
    orderBy: date
    orderDirection: asc
    where: { vAnchor: $vAnchorId }
  ) {
    id
    date

    composition {
      id
      unWrappingFees
      wrappingFees
      fees
      relayerFees
      token {
        ...TokenDetailsFragment
      }
      volume
    }

    numberOfDeposits
    numberOfTransfers
    numberOfWithdraws
  }
}

fragment DepositTxFragment on DepositTx {
  id
  depositor

  wrappedToken {
    ...TokenDetailsFragment
  }

  value
  finalValue

  isWrapAndDeposit

  fullFee
  wrappingFee
  RelayerFee

  fungibleTokenWrapper {
    ...FungibleTokenWrapperDetails
  }
  vAnchor {
    ...VAnchorDetailsFragment
  }
  transactionHash
  gasUsed
  blockTimestamp
  blockNumber
}

fragment WithdrawTxFragment on WithdrawTx {
  id
  beneficiary

  wrappedToken {
    ...TokenDetailsFragment
  }

  value
  finalValue

  isUnwrapAndWithdraw

  fullFee
  unWrappingFee
  RelayerFee

  fungibleTokenWrapper {
    ...FungibleTokenWrapperDetails
  }
  vAnchor {
    ...VAnchorDetailsFragment
  }
  transactionHash
  gasUsed
  blockTimestamp
  blockNumber
}

query depositTXesListing(
  $first: Int = 10
  $skip: Int = 0
  $block: Block_height
  $orderBy: DepositTx_orderBy
  $orderDirection: OrderDirection
  $where: DepositTx_filter
  $subgraphError: _SubgraphErrorPolicy_! = deny
) {
  depositTxes(
    block: $block
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    skip: $skip
    subgraphError: $subgraphError
    where: $where
  ) {
    ...DepositTxFragment
  }
}

query withdrawTXesListing(
  $where: WithdrawTx_filter
  $first: Int = 100
  $skip: Int = 0
  $orderBy: WithdrawTx_orderBy
  $block: Block_height
  $orderDirection: OrderDirection
  $subgraphError: _SubgraphErrorPolicy_! = deny
) {
  withdrawTxes(
    block: $block
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    skip: $skip
    subgraphError: $subgraphError
    where: $where
  ) {
    ...WithdrawTxFragment
  }
}

query depositTXDetails($id: ID!) {
  depositTx(id: $id) {
    ...DepositTxFragment
  }
}

query withdrawTXDetails($id: ID!) {
  withdrawTx(id: $id) {
    ...WithdrawTxFragment
  }
}

query discoverVAnchors {
  vanchors {
    id
  }
}
